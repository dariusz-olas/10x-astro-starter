{
  "openapi": "3.0.0",
  "info": {
    "title": "10xCards API",
    "version": "1.0.0",
    "description": "API dla aplikacji do nauki fiszek edukacyjnych",
    "contact": {
      "name": "API Support"
    }
  },
  "servers": [
    {
      "url": "http://localhost:4321",
      "description": "Development server"
    },
    {
      "url": "https://10x-astro-starter-dqx.pages.dev",
      "description": "Production server"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  },
  "security": [
    {
      "bearerAuth": []
    }
  ],
  "paths": {
    "/api/auth/logout": {
      "post": {
        "summary": "Wylogowuje użytkownika i czyści cookies sesji",
        "tags": [
          "Authentication"
        ],
        "responses": {
          "200": {
            "description": "Wylogowanie pomyślne",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "Wylogowano pomyślnie"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Błąd serwera",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": false
                    },
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/dashboard/review-history": {
      "get": {
        "summary": "Pobiera historię sesji powtórek użytkownika",
        "tags": [
          "Dashboard"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 10
            },
            "description": "Liczba sesji do pobrania (1-100)"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer",
              "minimum": 0,
              "default": 0
            },
            "description": "Przesunięcie (dla paginacji)"
          }
        ],
        "responses": {
          "200": {
            "description": "Historia sesji powtórek",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string",
                        "format": "uuid"
                      },
                      "completedAt": {
                        "type": "string",
                        "format": "date-time"
                      },
                      "cardsReviewed": {
                        "type": "integer"
                      },
                      "cardsCorrect": {
                        "type": "integer"
                      },
                      "accuracy": {
                        "type": "number"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Brak autoryzacji"
          },
          "500": {
            "description": "Błąd serwera"
          }
        }
      }
    },
    "/api/dashboard/stats": {
      "get": {
        "summary": "Pobiera statystyki użytkownika dla dashboardu",
        "tags": [
          "Dashboard"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Statystyki użytkownika",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "totalCards": {
                      "type": "integer",
                      "description": "Łączna liczba fiszek"
                    },
                    "cardsToReview": {
                      "type": "integer",
                      "description": "Liczba fiszek do powtórki"
                    },
                    "currentStreak": {
                      "type": "integer",
                      "description": "Aktualna seria dni z powtórkami"
                    },
                    "totalReviews": {
                      "type": "integer",
                      "description": "Łączna liczba powtórek"
                    },
                    "averageAccuracy": {
                      "type": "number",
                      "description": "Średnia dokładność (%)"
                    },
                    "mostActiveDay": {
                      "type": "string",
                      "description": "Najaktywniejszy dzień tygodnia"
                    },
                    "activeDaysLast30": {
                      "type": "integer",
                      "description": "Liczba aktywnych dni w ostatnich 30 dniach"
                    },
                    "activityChart": {
                      "type": "array",
                      "description": "Dane wykresu aktywności (ostatnie 30 dni)",
                      "items": {
                        "type": "object",
                        "properties": {
                          "date": {
                            "type": "string",
                            "format": "date"
                          },
                          "reviews": {
                            "type": "integer"
                          }
                        }
                      }
                    },
                    "accuracyChart": {
                      "type": "array",
                      "description": "Dane wykresu dokładności (ostatnie 10 sesji)",
                      "items": {
                        "type": "object",
                        "properties": {
                          "sessionId": {
                            "type": "string"
                          },
                          "accuracy": {
                            "type": "number"
                          }
                        }
                      }
                    },
                    "cardsDistribution": {
                      "type": "object",
                      "description": "Rozkład kart według poziomów"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Brak autoryzacji"
          },
          "500": {
            "description": "Błąd serwera"
          }
        }
      }
    },
    "/api/dashboard/tag-stats": {
      "get": {
        "summary": "Pobiera statystyki fiszek pogrupowane według tagów",
        "tags": [
          "Dashboard"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Statystyki według tagów",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "tag": {
                        "type": "string",
                        "description": "Nazwa tagu"
                      },
                      "cardCount": {
                        "type": "integer",
                        "description": "Liczba fiszek z tym tagiem"
                      },
                      "averageAccuracy": {
                        "type": "number",
                        "description": "Średnia poprawność (%)"
                      },
                      "lastReview": {
                        "type": "string",
                        "nullable": true,
                        "description": "Data ostatniej powtórki (format polski)"
                      },
                      "cardsDue": {
                        "type": "integer",
                        "description": "Liczba fiszek do powtórki"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Brak autoryzacji"
          },
          "500": {
            "description": "Błąd serwera"
          }
        }
      }
    },
    "/api/docs": {
      "get": {
        "summary": "Zwraca dokumentację API w formacie OpenAPI",
        "tags": [
          "Documentation"
        ],
        "responses": {
          "200": {
            "description": "Dokumentacja API",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        }
      }
    },
    "/api/generate-flashcards": {
      "post": {
        "summary": "Generuje fiszki z podanego tekstu za pomocą AI",
        "tags": [
          "Flashcards"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "text"
                ],
                "properties": {
                  "text": {
                    "type": "string",
                    "description": "Tekst źródłowy do wygenerowania fiszek",
                    "minLength": 1
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Fiszki wygenerowane pomyślnie",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "flashcards": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "front": {
                            "type": "string"
                          },
                          "back": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Nieprawidłowe dane (pusty tekst)"
          },
          "401": {
            "description": "Brak autoryzacji"
          },
          "500": {
            "description": "Błąd serwera lub API AI"
          }
        }
      }
    },
    "/api/review/next": {
      "get": {
        "summary": "Pobiera następne karty do powtórki",
        "tags": [
          "Review"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "force",
            "schema": {
              "type": "boolean"
            },
            "description": "Tryb force - zwraca wszystkie karty użytkownika zamiast tylko tych wymagających powtórki"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista kart do powtórki",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "cards": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "front": {
                            "type": "string"
                          },
                          "back": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Brak autoryzacji"
          },
          "500": {
            "description": "Błąd serwera"
          }
        }
      }
    },
    "/api/review/session-complete": {
      "post": {
        "summary": "Zapisuje ukończoną sesję powtórek",
        "tags": [
          "Review"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "cardsReviewed",
                  "cardsCorrect"
                ],
                "properties": {
                  "cardsReviewed": {
                    "type": "integer",
                    "minimum": 0,
                    "description": "Liczba przejrzanych kart"
                  },
                  "cardsCorrect": {
                    "type": "integer",
                    "minimum": 0,
                    "description": "Liczba poprawnie odpowiedzianych kart (musi być <= cardsReviewed)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Sesja zapisana pomyślnie",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "sessionId": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "accuracy": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Nieprawidłowe dane"
          },
          "401": {
            "description": "Brak autoryzacji"
          },
          "500": {
            "description": "Błąd serwera"
          }
        }
      }
    },
    "/api/review/submit": {
      "post": {
        "summary": "Zapisuje ocenę powtórki i aktualizuje harmonogram",
        "tags": [
          "Review"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "cardId",
                  "grade"
                ],
                "properties": {
                  "cardId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "ID fiszki"
                  },
                  "grade": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 3,
                    "description": "Ocena powtórki (0=Again, 1=Hard, 2=Good, 3=Easy)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Sukces - harmonogram zaktualizowany",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "cardId": {
                      "type": "string"
                    },
                    "next": {
                      "type": "object",
                      "properties": {
                        "ease": {
                          "type": "integer"
                        },
                        "intervalDays": {
                          "type": "integer"
                        },
                        "repetitions": {
                          "type": "integer"
                        },
                        "dueAt": {
                          "type": "string",
                          "format": "date-time"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Nieprawidłowe dane"
          },
          "401": {
            "description": "Brak autoryzacji"
          },
          "500": {
            "description": "Błąd serwera"
          }
        }
      }
    },
    "/api/version": {
      "get": {
        "summary": "Zwraca wersję aplikacji",
        "tags": [
          "System"
        ],
        "responses": {
          "200": {
            "description": "Wersja aplikacji",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "version": {
                      "type": "string",
                      "description": "Wersja w formacie YYYY-MM-DD.N",
                      "example": "2025-11-10.1"
                    }
                  }
                }
              }
            },
            "headers": {
              "Cache-Control": {
                "description": "Cache public przez 5 minut",
                "schema": {
                  "type": "string",
                  "example": "public, max-age=300, immutable"
                }
              }
            }
          },
          "500": {
            "description": "Błąd serwera",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "version": {
                      "type": "string",
                      "example": "unknown"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "tags": []
}